WT_DECLARE_WT_MEMBER(1,JavaScriptConstructor,"WSuggestionPopup",function(q,h,B,H,r,w,C,x,c){function e(a){return $(a).hasClass("Wt-suggest-onedit")||$(a).hasClass("Wt-suggest-dropdown")}function j(){return h.style.display!="none"}function k(a){h.style.display="block";d.positionAtWidget(h.id,a.id,d.Vertical)}function s(a){a=d.target(a||window.event);if(!d.hasTag(a,"UL")){for(;a&&!d.hasTag(a,"LI");)a=a.parentNode;a&&y(a)}}function y(a){var b=a.firstChild.firstChild,f=d.getElement(i),g=b.innerHTML;b=
b.getAttribute("sug");f.focus();B(f,g,b);q.emit(h,"select",a.id,f.id);m();i=null}function m(){h.style.display="none";if(i!=null&&D!=null){d.getElement(i).onkeydown=D;D=null}}function M(a){if(typeof d.theme==="object"&&d.theme.type==="bootstrap"&&d.theme.version===5)try{var b=getComputedStyle(a),f=parseInt(b.backgroundSize.match(/^([0-9]+)px ([0-9]+)px$/)[1],10),g=parseInt(b.backgroundPositionX.match(/^calc[(]100% - ([0-9]+)px[)]$/)[1],10);return f+g}catch(t){return 28}else return 16}function S(a){var b=
h.childNodes;for(n=a?b[0]:b[b.length-1];n;n=a?n.nextSibling:n.previousSibling)if(d.hasTag(n,"LI")&&n.style.display!="none")return n;return null}function T(a,b){for(a=b?a.nextSibling:a.previousSibling;a;a=b?a.nextSibling:a.previousSibling)if(d.hasTag(a,"LI"))if(a.style.display!="none")return a;return null}function I(a){var b=a.parentNode;if(a.offsetTop+a.offsetHeight>b.scrollTop+b.clientHeight)b.scrollTop=a.offsetTop+a.offsetHeight-b.clientHeight;else if(a.offsetTop<b.scrollTop)b.scrollTop=a.offsetTop}
$(".Wt-domRoot").add(h);h.wtObj=this;var u=this,d=q.WT,o=null,i=null,N=false,E=null,O=null,P=w,F=null,G=null,z=false;this.defaultValue=C;var D=null;this.showPopup=function(a){h.style.display="block";G=o=null;D=a.onkeydown;a.onkeydown=function(b){u.editKeyDown(this,b||window.event)}};this.editMouseMove=function(a,b){if(e(a))if(d.widgetCoordinates(a,b).x>a.offsetWidth-M(a)){a.classList&&a.classList.add("Wt-suggest-dropdown-hover");a.style.cursor="default"}else{a.classList&&a.classList.remove("Wt-suggest-dropdown-hover");
a.style.cursor=""}};this.showAt=function(a,b){m();i=a.id;z=true;u.refilter(b)};this.editClick=function(a,b){if(e(a))if(d.widgetCoordinates(a,b).x>a.offsetWidth-M(a))if(i!=a.id||!j())u.showAt(a,"");else{m();i=null}};this.editKeyDown=function(a,b){if(!e(a))return true;if(i!=a.id)if($(a).hasClass("Wt-suggest-onedit")){i=a.id;z=false}else if($(a).hasClass("Wt-suggest-dropdown")&&b.keyCode==40){i=a.id;z=true}else{i=null;return true}if(j()){var f=o?d.getElement(o):null;if(b.keyCode==13||b.keyCode==9){if(f){y(f);
d.cancelEvent(b);setTimeout(function(){a.focus()},0)}else m();return false}else if(b.keyCode==40||b.keyCode==38||b.keyCode==34||b.keyCode==33){if(b.type.toUpperCase()=="KEYDOWN"){N=true;d.cancelEvent(b,d.CancelDefaultAction)}if(b.type.toUpperCase()=="KEYPRESS"&&N==true){d.cancelEvent(b);return false}var g=f,t=b.keyCode==40||b.keyCode==34;if(g){b=b.keyCode==34||b.keyCode==33?h.clientHeight/f.offsetHeight:1;var p;for(p=0;g&&p<b;++p){var v=T(g,t);if(!v&&c)break;g=v}}else{g=S(t);I(g)}if(f){f.className=
"";o=null}if(g&&d.hasTag(g,"LI")){g.className="active";if(typeof q.theme==="object"&&q.theme.type==="bootstrap"&&q.theme.version>=4){f.firstChild.className=f.firstChild.className.replace("active","");g.firstChild.className+=" active"}o=g.id}return false}}return b.keyCode!=13&&b.keyCode!=9};this.filtered=function(a,b){E=a;P=b;u.refilter(G)};this.refilter=function(a){if(i){var b=o?d.getElement(o):null,f=d.getElement(i),g=H(f),t=h.childNodes,p=x&&a!=null?a:g(null);G=x?a:f.value;if(r>0||w)if(p.length<
r&&!z){m();return}else{a=P?p:p.substring(0,Math.max(E!==null?E.length:0,r));if(a!=E)if(a!=O){O=a;q.emit(h,"filter",a)}}var v=a=null;p=z&&p.length==0;var A,Q;A=0;for(Q=t.length;A<Q;++A){var l=t[A];if(d.hasTag(l,"LI")){var J=l.firstChild;if(l.orig==null)l.orig=J.firstChild.innerHTML;var K=g(l.orig),U=p||K.match;if(K.suggestion!=J.firstChild.innerHTML)J.firstChild.innerHTML=K.suggestion;if(U){if(l.style.display!="")l.style.display="";if(a==null)a=l;if(A==this.defaultValue)v=l}else if(l.style.display!=
"none")l.style.display="none";if(l.className!="")l.className=""}}if(a==null)m();else{if(!j()){k(f);u.showPopup(f);b=null}if((c||v)&&(!b||b.style.display=="none")){b=v||a;b.parentNode.scrollTop=0;o=b.id}if(b){b.className="active";if(typeof d.theme==="object"&&d.theme.type==="bootstrap"&&d.theme.version>=4)b.firstChild.className+=" active";I(b)}}}};this.editKeyUp=function(a,b){if(i!=null)if(e(a))if(!(!j()&&(b.keyCode==13||b.keyCode==9)))if(b.keyCode==27||b.keyCode==37||b.keyCode==39)m();else if(!(b.keyCode==
40||b.keyCode==38||b.keyCode==34||b.keyCode==33))if(a.value!=G){i=a.id;u.refilter(a.value)}else(a=o?d.getElement(o):null)&&I(a)};h.onclick=s;h.onscroll=function(){if(F){clearTimeout(F);var a=d.getElement(i);a&&a.focus()}};this.delayHide=function(a){F=setTimeout(function(){F=null;if(h&&(a==null||i==a.id))m()},300)}});
WT_DECLARE_WT_MEMBER(2,JavaScriptConstructor,"WSuggestionPopupStdMatcher",function(q,h,B,H,r,w,C){function x(c){var e=c.value;c=c.selectionStart?c.selectionStart:e.length;for(var j=B?e.lastIndexOf(B,c-1)+1:0;j<c&&H.indexOf(e.charAt(j))!=-1;)++j;return{start:j,end:c}}this.match=function(c){var e=x(c),j=c.value.substring(e.start,e.end),k;if(w.length==0)if(r.length!=0){k="(^|(?:[";for(c=0;c<r.length;++c){for(e=r.charCodeAt(c).toString(16);e.length<4;)e="0"+e;k+="\\u"+e}k+="]))"}else k="(^)";else k="("+
w+")";k+="("+j.replace(new RegExp("([\\^\\\\\\][\\-.$*+?()|{}])","g"),"\\$1")+")";k=new RegExp(k,"gi");return function(s){if(!s)return j;var y=false;if(j.length){var m=s.replace(k,"$1"+q+"$2"+h);if(m!=s){y=true;s=m}}return{match:y,suggestion:s}}};this.replace=function(c,e,j){e=x(c);var k=c.value.substring(0,e.start)+j+C;if(e.end<c.value.length)k+=c.value.substring(e.end,c.value.length);c.value=k;if(c.selectionStart){c.selectionStart=e.start+j.length+C.length;c.selectionEnd=c.selectionStart}}});
