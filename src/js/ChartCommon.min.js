WT_DECLARE_WT_MEMBER(2,JavaScriptConstructor,"ChartCommon",function(B){function F(a,b,c,e){function f(n){return c?b[n]:b[k-1-n]}function h(n){for(;f(n)[2]===y||f(n)[2]===C;)n--;return n}var i=l;if(e)i=m;var k=b.length;e=Math.floor(k/2);e=h(e);var q=0,o=k,d=false;if(f(0)[i]>a)return c?-1:k;if(f(k-1)[i]<a)return c?k:-1;for(;!d;){var g=e+1;if(g<k&&(f(g)[2]===y||f(g)[2]===C))g+=2;if(f(e)[i]>a){o=e;e=Math.floor((o+q)/2);e=h(e)}else if(f(e)[i]===a)d=true;else if(g<k&&f(g)[i]>a)d=true;else if(g<k&&f(g)[i]===
a){e=g;d=true}else{q=e;e=Math.floor((o+q)/2);e=h(e)}}return c?e:k-1-e}function H(a,b){return b[0][a]<b[b.length-1][a]}var y=2,C=3,l=0,m=1,G=this;B=B.WT.gfxUtils;var z=B.rect_top,A=B.rect_bottom,v=B.rect_left,D=B.rect_right,I=B.transform_mult;this.findClosestPoint=function(a,b,c){var e=l;if(c)e=m;var f=H(e,b);c=F(a,b,f,c);if(c<0)c=0;if(c>=b.length)return[b[b.length-1][l],b[b.length-1][m]];if(c>=b.length)c=b.length-2;if(b[c][e]===a)return[b[c][l],b[c][m]];var h=f?c+1:c-1;if(f&&b[h][2]==y)h+=2;if(!f&&
h<0)return[b[c][l],b[c][m]];if(!f&&h>0&&b[h][2]==C)h-=2;f=Math.abs(a-b[c][e]);a=Math.abs(b[h][e]-a);return f<a?[b[c][l],b[c][m]]:[b[h][l],b[h][m]]};this.minMaxY=function(a,b){b=b?l:m;for(var c=a[0][b],e=a[0][b],f=1;f<a.length;++f)if(a[f][2]!==y&&a[f][2]!==C&&a[f][2]!==5){if(a[f][b]>e)e=a[f][b];if(a[f][b]<c)c=a[f][b]}return[c,e]};this.projection=function(a,b){var c=Math.cos(a);a=Math.sin(a);var e=c*a,f=-b[0]*c-b[1]*a;return[c*c,e,e,a*a,c*f+b[0],a*f+b[1]]};this.distanceSquared=function(a,b){a=[b[l]-
a[l],b[m]-a[m]];return a[l]*a[l]+a[m]*a[m]};this.distanceLessThanRadius=function(a,b,c){return c*c>=G.distanceSquared(a,b)};this.toZoomLevel=function(a){return Math.floor(Math.log(a)/Math.LN2+0.5)+1};this.isPointInRect=function(a,b){var c;if(a.x!==undefined){c=a.x;a=a.y}else{c=a[0];a=a[1]}return c>=v(b)&&c<=D(b)&&a>=z(b)&&a<=A(b)};this.toDisplayCoord=function(a,b,c,e,f){if(c){a=[(a[l]-f[0])/f[2],(a[m]-f[1])/f[3]];e=[e[0]+a[m]*e[2],e[1]+a[l]*e[3]]}else{a=[(a[l]-f[0])/f[2],1-(a[m]-f[1])/f[3]];e=[e[0]+
a[l]*e[2],e[1]+a[m]*e[3]]}return I(b,e)};this.findYRange=function(a,b,c,e,f,h,i,k,q){if(a.length!==0){var o=G.toDisplayCoord([c,0],[1,0,0,1,0,0],f,h,i),d=G.toDisplayCoord([e,0],[1,0,0,1,0,0],f,h,i),g=f?m:l,n=f?l:m,p=H(g,a),j=F(o[g],a,p,f),r=F(d[g],a,p,f),s,t,w=Infinity,x=-Infinity,E=j===r&&j===a.length||j===-1&&r===-1;if(!E){if(p)if(j<0)j=0;else{j++;if(a[j]&&a[j][2]===y)j+=2}else if(j>=a.length-1)j=a.length-2;if(!p&&r<0)r=0;for(s=Math.min(j,r);s<=Math.max(j,r)&&s<a.length;++s)if(a[s][2]!==y&&a[s][2]!==
C){if(a[s][n]<w)w=a[s][n];if(a[s][n]>x)x=a[s][n]}if(p&&j>0||!p&&j<a.length-1){if(p){t=j-1;if(a[t]&&a[t][2]===C)t-=2}else{t=j+1;if(a[t]&&a[t][2]===y)t+=2}s=(o[g]-a[t][g])/(a[j][g]-a[t][g]);j=a[t][n]+s*(a[j][n]-a[t][n]);if(j<w)w=j;if(j>x)x=j}if(p&&r<a.length-1||!p&&r>0){if(p){p=r+1;if(a[p][2]===y)p+=2}else{p=r-1;if(a[p][2]===C)p-=2}s=(d[g]-a[r][g])/(a[p][g]-a[r][g]);j=a[r][n]+s*(a[p][n]-a[r][n]);if(j<w)w=j;if(j>x)x=j}}var u;a=i[2]/(e-c);c=f?2:3;if(!E){u=h[c]/(x-w);u=h[c]/(h[c]/u+20);if(u>q.y[b])u=q.y[b];
if(u<k.y[b])u=k.y[b]}b=f?[o[m]-z(h),!E?(w+x)/2-h[2]/u/2-v(h):0]:[o[l]-v(h),!E?-((w+x)/2+h[3]/u/2-A(h)):0];return{xZoom:a,yZoom:u,panPoint:b}}};this.matchXAxis=function(a,b,c,e,f){function h(){return e.length}function i(g){return e[g].side}function k(g){return e[g].width}function q(g){return e[g].minOffset}function o(g){return e[g].maxOffset}if(f){if(b<z(c)||b>A(c))return-1}else if(a<v(c)||a>D(c))return-1;for(var d=0;d<h();++d)if(f)if((i(d)==="min"||i(d)==="both")&&a>=v(c)-q(d)-k(d)&&a<=v(c)-q(d))return d;
else{if((i(d)==="max"||i(d)==="both")&&a>=D(c)+o(d)&&a<=D(c)+o(d)+k(d))return d}else if((i(d)==="min"||i(d)==="both")&&b<=A(c)+q(d)+k(d)&&b>=A(c)+q(d))return d;else if((i(d)==="max"||i(d)==="both")&&b<=z(c)-o(d)&&b>=z(c)-o(d)-k(d))return d;return-1};this.matchYAxis=function(a,b,c,e,f){function h(){return e.length}function i(g){return e[g].side}function k(g){return e[g].width}function q(g){return e[g].minOffset}function o(g){return e[g].maxOffset}if(f){if(a<v(c)||a>D(c))return-1}else if(b<z(c)||b>
A(c))return-1;for(var d=0;d<h();++d)if(f)if((i(d)==="min"||i(d)==="both")&&b>=z(c)-q(d)-k(d)&&b<=z(c)-q(d))return d;else{if((i(d)==="max"||i(d)==="both")&&b>=A(c)+o(d)&&b<=A(c)+o(d)+k(d))return d}else if((i(d)==="min"||i(d)==="both")&&a>=v(c)-q(d)-k(d)&&a<=v(c)-q(d))return d;else if((i(d)==="max"||i(d)==="both")&&a>=D(c)+o(d)&&a<=D(c)+o(d)+k(d))return d;return-1}});
