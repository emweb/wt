WT_DECLARE_WT_MEMBER(1,JavaScriptConstructor,"WGLWidget",function(r,h){jQuery.data(h,"obj",this);var f=r.WT,l=f.glMatrix.vec3,b=f.glMatrix.mat4;this.ctx=null;this.initializeGL=function(){};this.paintGL=function(){};this.resizeGL=function(){};this.updates=[];this.initialized=false;this.preloadingBuffers=this.preloadingTextures=0;var i=null,j=null,m=null,n=0,o=0,e=null,p=0,q=0;this.discoverContext=function(a){if(h.getContext){try{this.ctx=h.getContext("webgl",{antialias:true})}catch(c){}if(this.ctx==
null)try{this.ctx=h.getContext("experimental-webgl")}catch(d){}if(this.ctx==null){h.parentNode.insertBefore(h.firstChild,h);h.style.display="none";a()}}return this.ctx};this.setLookAtParams=function(a,c,d,g,k){e=a;j=c;m=d;n=g;o=k};this.mouseDragLookAt=function(a,c){if(this.ctx!=null){var d=f.pageCoordinates(c);a=d.x-i.x;d=d.y-i.y;var g=l.create();g[0]=e[0];g[1]=e[4];g[2]=e[8];var k=b.create();b.identity(k);b.translate(k,j);b.rotate(k,d*n,g);b.rotate(k,a*o,m);l.negate(j);b.translate(k,j);l.negate(j);
b.multiply(e,k,e);this.paintGL();i=f.pageCoordinates(c)}};this.mouseWheelLookAt=function(a,c){if(this.ctx!=null){f.cancelEvent(c);a=f.wheelDelta(c);a=Math.pow(1.2,a);b.translate(e,j);b.scale(e,[a,a,a]);l.negate(j);b.translate(e,j);l.negate(j);this.paintGL()}};this.setWalkParams=function(a,c,d){e=a;p=c;q=d};this.mouseDragWalk=function(a,c){if(this.ctx!=null){var d=f.pageCoordinates(c);a=d.x-i.x;d=d.y-i.y;var g=b.create();b.identity(g);b.rotateY(g,a*q);a=l.create();a[0]=0;a[1]=0;a[2]=-p*d;b.translate(g,
a);b.multiply(g,e,e);this.paintGL();i=f.pageCoordinates(c)}};this.mouseDown=function(a,c){f.capture(null);f.capture(h);i=f.pageCoordinates(c)};this.mouseUp=function(){if(i!=null)i=null};this.handlePreload=function(){if(this.preloadingTextures==0&&this.preloadingBuffers==0){if(this.initialized){var a;for(a in this.updates)this.updates[a]();this.updates=[]}else this.initializeGL();this.resizeGL();this.paintGL()}}});
