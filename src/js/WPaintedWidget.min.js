WT_DECLARE_WT_MEMBER(10,JavaScriptConstructor,"WPaintedWidget",function(W,w){jQuery.data(w,"obj",this);var x=this;this.imagePreloaders=[];this.images=[];this.canvas=document.getElementById("c"+w.id);this.repaint=function(){};this.widget=w;this.cancelPreloaders=function(){for(var y=0;y<x.imagePreloaders.length;++y)x.imagePreloaders[y].cancel();x.imagePreloaders=[]}});
WT_DECLARE_WT_MEMBER(11,JavaScriptObject,"gfxUtils",function(){function W(){var g=this;this.path_crisp=function(a){return a.map(function(b){return[Math.floor(b[0])+0.5,Math.floor(b[1])+0.5,b[2]]})};this.transform_mult=function(a,b){if(b.length===2){var e=b[0],h=b[1];return[a[w]*e+a[y]*h+a[D],a[x]*e+a[A]*h+a[E]]}if(b.length===3){if(b[2]===J||b[2]===K)return b.slice(0);e=b[0];h=b[1];return[a[w]*e+a[y]*h+a[D],a[x]*e+a[A]*h+a[E],b[2]]}if(b.length===4){var i,d,c,o;d=g.transform_mult(a,[b[0],b[1]]);e=d[0];
i=d[0];h=d[1];d=d[1];for(c=0;c<3;++c){o=g.transform_mult(a,c==0?[g.rect_left(b),g.rect_bottom(b)]:c==1?[g.rect_right(b),g.rect_top(b)]:[g.rect_right(b),g.rect_bottom(b)]);e=Math.min(e,o[0]);i=Math.max(i,o[0]);h=Math.min(h,o[1]);d=Math.max(d,o[1])}return[e,h,i-e,d-h]}if(b.length===6)return[a[w]*b[w]+a[y]*b[x],a[x]*b[w]+a[A]*b[x],a[w]*b[y]+a[y]*b[A],a[x]*b[y]+a[A]*b[A],a[w]*b[D]+a[y]*b[E]+a[D],a[x]*b[D]+a[A]*b[E]+a[E]];return[]};this.transform_apply=function(a,b){var e=g.transform_mult;return b.map(function(h){return e(a,
h)})};this.transform_det=function(a){return a[w]*a[A]-a[x]*a[y]};this.transform_adjoint=function(a){var b=a[w],e=a[y],h=a[x],i=a[A],d=a[D];a=a[E];return[i,-e,-h,b,a*h-d*i,-(a*b-d*e)]};this.transform_inverted=function(a){var b=g.transform_det(a);if(b!=0){a=g.transform_adjoint(a);return[a[w]/b,a[y]/b,a[x]/b,a[A]/b,a[D]/b,a[E]/b]}else{console.log("inverted(): oops, determinant == 0");return a}};this.transform_assign=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5]};this.transform_equal=
function(a,b){return a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]&&a[3]==b[3]&&a[4]==b[4]&&a[5]==b[5]};this.css_text=function(a){return"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")"};this.arcPosition=function(a,b,e,h,i){i=-i/180*Math.PI;return[a+e*Math.cos(i),b+h*Math.sin(i)]};this.pnpoly=function(a,b){var e=false,h=0,i=0,d=a[0];a=a[1];var c,o,l;for(c=0;c<b.length;++c){o=h;l=i;if(b[c][2]===X){l=g.arcPosition(b[c][0],b[c][1],b[c+1][0],b[c+1][1],b[c+2][0]);o=l[0];l=l[1]}else if(b[c][2]===K){l=g.arcPosition(b[c-
2][0],b[c-2][1],b[c-1][0],b[c-1][1],b[c][0]+b[c][1]);o=l[0];l=l[1]}else if(b[c][2]!==J){o=b[c][0];l=b[c][1]}if(b[c][2]!==G)if(i>a!==l>a&&d<(o-h)*(a-i)/(l-i)+h)e=!e;h=o;i=l}return e};this.rect_intersection=function(a,b){a=g.rect_normalized(a);b=g.rect_normalized(b);var e=g.rect_top,h=g.rect_bottom,i=g.rect_left,d=g.rect_right;i=Math.max(i(a),i(b));d=Math.min(d(a),d(b));e=Math.max(e(a),e(b));a=Math.min(h(a),h(b));return[i,e,d-i,a-e]};this.drawRect=function(a,b,e,h){b=g.rect_normalized(b);var i=g.rect_top(b),
d=g.rect_bottom(b),c=g.rect_left(b);b=g.rect_right(b);path=[[c,i,G],[b,i,F],[b,d,F],[c,d,F],[c,i,F]];g.drawPath(a,path,e,h,false)};this.drawPath=function(a,b,e,h,i){function d(m){return m[0]}function c(m){return m[1]}function o(m){return m[2]}var l=0,s=[],p=[],t=[];a.beginPath();b.length>0&&o(b[0])!==G&&a.moveTo(0,0);for(l=0;l<b.length;l++){var j=b[l];switch(o(j)){case G:Math.abs(d(j))<=1048576&&Math.abs(c(j))<=1048576&&a.moveTo(d(j),c(j));break;case F:(function(){var m=l===0?[0,0]:b[l-1];if(!e&&
!i&&h&&(Math.abs(d(m))>1048576||Math.abs(c(m))>1048576||Math.abs(d(j))>1048576||Math.abs(c(j))>1048576)){(function(){function r(M,N,O){return(O-M)/N}function u(M,N,O){return M+O*N}var n=a.wtTransform?a.wtTransform:[1,0,0,1,0,0],I=g.transform_inverted(n),f=g.transform_mult(n,m),q=g.transform_mult(n,j),B=d(q)-d(f),C=c(q)-c(f);n=a.canvas.width+50;var z=a.canvas.height+50,k,v=null,H=k=null;k=null;if(d(f)<-50&&d(q)>-50){k=r(d(f),B,-50);v=[-50,u(c(f),C,k),k]}else if(d(f)>n&&d(q)<n){k=r(d(f),B,n);v=[n,u(c(f),
C,k),k]}else if(d(f)>-50&&d(f)<n)v=[d(f),c(f),0];else return;if(c(f)<-50&&c(q)>-50){k=r(c(f),C,-50);k=[u(d(f),B,k),-50,k]}else if(c(f)>z&&c(q)<z){k=r(c(f),C,z);k=[u(d(f),B,k),z,k]}else if(c(f)>-50&&c(f)<z)k=[d(f),c(f),0];else return;v=v[2]>k[2]?[v[0],v[1]]:[k[0],k[1]];if(!(d(v)<-50||d(v)>n||c(v)<-50||c(v)>z)){if(d(f)<n&&d(q)>n){k=r(d(f),B,n);H=[n,u(c(f),C,k),k]}else if(d(f)>-50&&d(q)<-50){k=r(d(f),B,-50);H=[-50,u(c(f),C,k),k]}else if(d(q)>-50&&d(q)<n)H=[d(q),c(q),1];else return;if(c(f)<z&&c(q)>z){k=
r(c(f),C,z);k=[u(d(f),B,k),z,k]}else if(c(f)>-50&&c(q)<-50){k=r(c(f),C,-50);k=[u(d(f),B,k),-50,k]}else if(d(q)>-50&&c(q)<z)k=[d(q),c(q),1];else return;f=H[2]<k[2]?[H[0],H[1]]:[k[0],k[1]];if(!(d(f)<-50||d(f)>n||c(f)<-50||c(f)>z)){v=g.transform_mult(I,v);f=g.transform_mult(I,f);a.moveTo(v[0],v[1]);a.lineTo(f[0],f[1])}}})();Math.abs(d(j))<=1048576&&Math.abs(c(j))<=1048576&&a.moveTo(d(j),c(j))}else a.lineTo(d(j),c(j))})();break;case aa:s.push(d(j),c(j));break;case ba:s.push(d(j),c(j));break;case P:s.push(d(j),
c(j));a.bezierCurveTo.apply(a,s);s=[];break;case X:p.push(d(j),c(j));break;case J:p.push(d(j));break;case K:p.push(d(j)*Math.PI/180,c(j)*Math.PI/180,c(j)>0);a.arc.apply(a,p);p=[];break;case ca:t.push(d(j),c(j));break;case Q:t.push(d(j),c(j));a.quadraticCurveTo.apply(a,t);t=[];break}}e&&a.fill();h&&a.stroke();i&&a.clip()};this.drawStencilAlongPath=function(a,b,e,h,i,d){function c(t){return t[0]}function o(t){return t[1]}function l(t){return t[2]}var s=0;for(s=0;s<e.length;s++){var p=e[s];if(!(d&&a.wtClipPath&&
!g.pnpoly(p,g.transform_apply(a.wtClipPathTransform,a.wtClipPath))))if(l(p)==G||l(p)==F||l(p)==Q||l(p)==P){p=g.transform_apply([1,0,0,1,c(p),o(p)],b);g.drawPath(a,p,h,i,false)}}};this.drawText=function(a,b,e,h,i){if(!(i&&a.wtClipPath&&!g.pnpoly(i,g.transform_apply(a.wtClipPathTransform,a.wtClipPath)))){var d=e&S;var c=i=null;switch(e&da){case Y:a.textAlign="left";i=g.rect_left(b);break;case Z:a.textAlign="right";i=g.rect_right(b);break;case $:a.textAlign="center";i=g.rect_center(b).x;break}switch(d){case T:a.textBaseline=
"top";c=g.rect_top(b);break;case U:a.textBaseline="bottom";c=g.rect_bottom(b);break;case V:a.textBaseline="middle";c=g.rect_center(b).y;break}if(!(i==null||c==null)){b=a.fillStyle;a.fillStyle=a.strokeStyle;a.fillText(h,i,c);a.fillStyle=b}}};this.calcYOffset=function(a,b,e,h){return h===V?-((b-1)*e/2)+a*e:h===T?a*e:h===U?-(b-1-a)*e:0};this.drawTextOnPath=function(a,b,e,h,i,d,c,o,l){function s(f){return f[0]}function p(f){return f[1]}function t(f){return f[2]}var j=0,m=0;h=g.transform_apply(h,i);for(j=
0;j<i.length;j++){if(j>=b.length)break;m=i[j];var r=h[j],u=b[j].split("\n");if(t(m)==G||t(m)==F||t(m)==Q||t(m)==P)if(d==0)for(m=0;m<u.length;m++){var n=g.calcYOffset(m,u.length,c,o&S);g.drawText(a,[e[0]+s(r),e[1]+p(r)+n,e[2],e[3]],o,u[m],l?[s(r),p(r)]:null)}else{n=d*Math.PI/180;m=Math.cos(-n);n=-Math.sin(-n);var I=-n;a.save();a.transform(m,I,n,m,s(r),p(r));for(m=0;m<u.length;m++){n=g.calcYOffset(m,u.length,c,o&S);g.drawText(a,[e[0],e[1]+n,e[2],e[3]],o,u[m],l?[s(r),p(r)]:null)}a.restore()}}};this.setClipPath=
function(a,b,e,h){if(h){a.setTransform.apply(a,e);g.drawPath(a,b,false,false,true);a.setTransform(1,0,0,1,0,0)}a.wtClipPath=b;a.wtClipPathTransform=e};this.removeClipPath=function(a){delete a.wtClipPath;delete a.wtClipPathTransform};this.rect_top=function(a){return a[1]};this.rect_bottom=function(a){return a[1]+a[3]};this.rect_right=function(a){return a[0]+a[2]};this.rect_left=function(a){return a[0]};this.rect_topleft=function(a){return[a[0],a[1]]};this.rect_topright=function(a){return[a[0]+a[2],
a[1]]};this.rect_bottomleft=function(a){return[a[0],a[1]+a[3]]};this.rect_bottomright=function(a){return[a[0]+a[2],a[1]+a[3]]};this.rect_center=function(a){return{x:(2*a[0]+a[2])/2,y:(2*a[1]+a[3])/2}};this.rect_normalized=function(a){var b,e,h;if(a[2]>0){b=a[0];h=a[2]}else{b=a[0]+a[2];h=-a[2]}if(a[3]>0){e=a[1];a=a[3]}else{e=a[1]+a[3];a=-a[3]}return[b,e,h,a]}}var w=0,x=1,y=2,A=3,D=4,E=5,G=0,F=1,aa=2,ba=3,P=4,ca=5,Q=6,X=7,J=8,K=9,Y=1,Z=2,$=4,T=128,V=512,U=1024,S=112|T|256|V|U|2048,da=Y|Z|$|8;return new W}());
