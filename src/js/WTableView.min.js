WT_DECLARE_WT_MEMBER(1,JavaScriptConstructor,"WTableView",function(r,i,d,o,p,F){function w(a){var b=-1,c=-1,e=false,k=false,g=null;for(a=f.target(a);a;){var h=$(a);if(h.hasClass("Wt-tv-contents"))break;else if(h.hasClass("Wt-tv-c")){if(a.getAttribute("drop")==="true")k=true;if(h.hasClass(F))e=true;g=a;a=a.parentNode;b=a.className.split(" ")[0].substring(7)*1;c=h.index();break}a=a.parentNode}return{columnId:b,rowIdx:c,selected:e,drop:k,el:g}}function C(){return f.pxself(d.firstChild,"lineHeight")}
function x(a){var b,c,e=a.parentNode.childNodes;b=0;for(c=e.length;b<c;++b)if(e[b]==a)return b;return-1}function G(a,b){var c=$(document.body).hasClass("Wt-rtl");if(c)b=-b;var e=a.className.split(" ")[0],k=e.substring(7)*1,g=a.parentNode,h=g.parentNode!==o,j=h?p.firstChild:d.firstChild,l=j.firstChild;e=$(j).find("."+e).get(0);var n=a.nextSibling,m=e.nextSibling,s=f.pxself(a,"width")-1+b,t=f.pxself(g,"width")+b+"px";g.style.width=j.style.width=l.style.width=t;if(h){p.style.width=t;p.firstChild.style.width=
t;d.style.left=t;o.style.left=t}a.style.width=s+1+"px";for(e.style.width=s+7+"px";n;n=n.nextSibling)if(m){if(c)m.style.right=f.pxself(m,"right")+b+"px";else m.style.left=f.pxself(m,"left")+b+"px";m=m.nextSibling}r.emit(i,"columnResized",k,parseInt(s));H.autoJavaScript()}jQuery.data(i,"obj",this);var H=this,f=r.WT,y=0,z=0,A=0,B=0,u=0,v=0,D=0,E=0;d.onscroll=function(){v=o.scrollLeft=d.scrollLeft;u=p.scrollTop=d.scrollTop;if(!(d.scrollTop==0&&f.isAndroid))if(d.clientWidth&&d.clientHeight&&(d.scrollTop<
A||d.scrollTop>B||d.scrollLeft<y||d.scrollLeft>z))r.emit(i,"scrolled",d.scrollLeft,d.scrollTop,d.clientWidth,d.clientHeight)};d.wtResize=function(a,b,c){if(b-D>(z-y)/2||c-E>(B-A)/2){D=b;E=c;r.emit(i,"scrolled",a.scrollLeft,a.scrollTop,a.clientWidth,a.clientHeight==a.firstChild.clientHeight?-1:a.clientHeight)}};this.mouseDown=function(a,b){f.capture(null);a=w(b);i.getAttribute("drag")==="true"&&a.selected&&r._p_.dragStart(i,b)};this.resizeHandleMDown=function(a,b){var c=a.parentNode,e=-(f.pxself(c,
"width")-1),k=1E4;if($(document.body).hasClass("Wt-rtl")){var g=e;e=-k;k=-g}new f.SizeHandle(f,"h",a.offsetWidth,i.offsetHeight,e,k,"Wt-hsh",function(h){G(c,h)},a,i,b,-2,-1)};this.scrolled=function(a,b,c,e){y=a;z=b;A=c;B=e};this.resetScroll=function(){o.scrollLeft=v;d.scrollLeft=v;d.scrollTop=u;p.scrollTop=u};this.scrollTo=function(a,b,c){if(b!=-1){a=d.scrollTop;var e=d.clientHeight;if(c==0)if(a+e<b)c=1;else if(b<a)c=2;switch(c){case 1:d.scrollTop=b;break;case 2:d.scrollTop=b-(e-C());break;case 3:d.scrollTop=
b-(e-C())/2;break}d.onscroll()}};var q=null;i.handleDragDrop=function(a,b,c,e,k){if(q){q.className=q.classNameOrig;q=null}if(a!="end"){var g=w(c);if(!g.selected&&g.drop)if(a=="drop")r.emit(i,{name:"dropEvent",eventObject:b,event:c},g.rowIdx,g.columnId,e,k);else{b.className="Wt-valid-drop";q=g.el;q.classNameOrig=q.className;q.className+=" Wt-drop-site"}else b.className=""}};i.onkeydown=function(a){var b=a||window.event;if(b.keyCode==9){f.cancelEvent(b);var c=w(b);if(c.el){a=c.el.parentNode;c=x(c.el);
var e=x(a),k=a.parentNode.childNodes.length,g=a.childNodes.length;b=b.shiftKey;for(var h=false,j=c,l;;){for(;b?j>=0:j<g;j=b?j-1:j+1)for(l=j==c&&!h?b?e-1:e+1:b?k-1:0;b?l>=0:l<k;l=b?l-1:l+1){if(j==c&&l==e)return;a=a.parentNode.childNodes[l];var n=$(a.childNodes[j]).find(":input");if(n.size()>0){setTimeout(function(){n.focus()},0);return}}j=b?g-1:0;h=true}}}else if(b.keyCode>=37&&b.keyCode<=40){h=f.target(b);function m(s){return f.hasTag(s,"INPUT")&&s.type=="text"||f.hasTag(s,"TEXTAREA")}if(!f.hasTag(h,
"SELECT")){c=w(b);if(c.el){a=c.el.parentNode;c=x(c.el);e=x(a);k=a.parentNode.childNodes.length;g=a.childNodes.length;switch(b.keyCode){case 39:if(m(h)){j=f.getSelectionRange(h);if(j.start!=h.value.length)return}e++;break;case 38:c--;break;case 37:if(m(h)){j=f.getSelectionRange(h);if(j.start!=0)return}e--;break;case 40:c++;break;default:return}f.cancelEvent(b);if(c>-1&&c<g&&e>-1&&e<k){a=a.parentNode.childNodes[e];n=$(a.childNodes[c]).find(":input");n.size()>0&&setTimeout(function(){n.focus()},0)}}}}};
this.autoJavaScript=function(){if(i.parentNode==null){i=d=o=null;this.autoJavaScript=function(){}}else if(!f.isHidden(i)){if(!f.isIE&&(u!=d.scrollTop||v!=d.scrollLeft)){o.scrollLeft=d.scrollLeft=v;p.scrollTop=d.scrollTop=u}var a=i.offsetWidth-f.px(i,"borderLeftWidth")-f.px(i,"borderRightWidth"),b=d.offsetWidth-d.clientWidth;a-=b;a-=p.clientWidth;if(a>200&&a!=d.tw){d.tw=a;d.style.width=a+b+"px";o.style.width=a+"px";if(!f.isIE)o.style.marginRight=b+"px"}a=d.offsetHeight-d.clientHeight;if((b=p.style)&&
b.marginBottom!==a+"px"){b.marginBottom=a+"px";r.layouts2.adjust(i.children[0].id,[[1,0]])}}}});
